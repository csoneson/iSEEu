<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The MAPlot class — MAPlot-class • iSEEu</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="The MAPlot class — MAPlot-class" />
<meta property="og:description" content="The MAPlot is a RowDataPlot subclass that is dedicated to creating a MA plot.
It retrieves the log-fold change and average abundance and creates a row-based plot where each point represents a feature.
Users are expected to load relevant statistics into the rowData of a SummarizedExperiment." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">iSEEu</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.99.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/iSEEu_contribute_eurobioc2019.html">iSEEu_contribute_eurobioc2019
</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/iSEE/iSEEu">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The MAPlot class</h1>
    <small class="dont-index">Source: <a href='https://github.com/iSEE/iSEEu/blob/master/R/MAPlot.R'><code>R/MAPlot.R</code></a></small>
    <div class="hidden name"><code>MAPlot-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The MAPlot is a RowDataPlot subclass that is dedicated to creating a MA plot.
It retrieves the log-fold change and average abundance and creates a row-based plot where each point represents a feature.
Users are expected to load relevant statistics into the <code>rowData</code> of a SummarizedExperiment.</p>
    </div>



    <h2 class="hasAnchor" id="slot-overview"><a class="anchor" href="#slot-overview"></a>Slot overview</h2>

    

<p>The following slots control the thresholds used in the visualization:</p><ul>
<li><p><code>PValueField</code>, a string specifying the field of <code>rowData</code> containing the p-values.
See <code>?<a href='utils-de.html'>.getAcceptablePValueFields</a></code> for more details.</p></li>
<li><p><code>PValueThreshold</code>, a numeric scalar in (0, 1] specifying the threshold to use on the (adjusted) p-value.
Defaults to 0.05.</p></li>
<li><p><code>LogFCThreshold</code>, a non-negative numeric scalar specifying the threshold to use on the log-fold change.
Defaults to 0.</p></li>
<li><p><code>PValueCorrection</code>, a string specifying the multiple testing correction to apply.
Defaults to <code>"BH"</code>, but can take any value from <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust.methods</a></code>.</p></li>
</ul>

<p>In addition, this class inherits all slots from its parent RowDataPlot,
RowDotPlot, DotPlot and Panel classes.</p>
    <h2 class="hasAnchor" id="constructor"><a class="anchor" href="#constructor"></a>Constructor</h2>

    

<p><code>MAPlot(...)</code> creates an instance of a MAPlot class,
where any slot and its value can be passed to <code>...</code> as a named argument.</p>
    <h2 class="hasAnchor" id="supported-methods"><a class="anchor" href="#supported-methods"></a>Supported methods</h2>

    

<p>In the following code snippets, <code>x</code> is an instance of a RowDataPlot class.
Refer to the documentation for each method for more details on the remaining arguments.</p>
<p>For setting up data values:</p><ul>
<li><p><code>.cacheCommonInfo(x)</code> adds a <code>"MAPlot"</code> entry containing <code>pval.rowData.names</code>, <code>ave.rowData.names</code> and <code>lfc.rowData.names</code>.
Each of these is a character vector of permissible names for p-values, average abundances and log-fold changes, respectively;
see <code>?<a href='utils-de.html'>.getAcceptablePValueFields</a></code> for details.
This will also call the equivalent RowDataPlot method.</p></li>
<li><p><code>.refineParameters(x, se)</code> returns <code>x</code> after setting <code>XAxis="Row data"</code>.
This will also call the equivalent RowDataPlot method for further refinements to <code>x</code>.
If valid p-value and log-fold change fields are not available, <code>NULL</code> is returned instead.</p></li>
</ul>

<p>For defining the interface:</p><ul>
<li><p><code>.defineDataInterface(x, se, select_info)</code> returns a list of interface elements for manipulating all slots described above.</p></li>
<li><p><code>.panelColor(x)</code> will return the specified default color for this panel class.</p></li>
<li><p><code>.allowableXAxisChoices(x, se)</code> returns a character vector specifying the acceptable average abundance-related variables in <code>rowData(se)</code> that can be used as choices for the x-axis, see <code>?<a href='utils-de.html'>.getAcceptableAveAbFields</a></code>.</p></li>
<li><p><code>.allowableYAxisChoices(x, se)</code> returns a character vector specifying the acceptable log-fold change-related variables in <code>rowData(se)</code> that can be used as choices for the y-axis, see <code>?<a href='utils-de.html'>.getAcceptableLogFCFields</a></code>.</p></li>
<li><p><code>.hideInterface(x, field)</code> will return <code>TRUE</code> for <code>field="XAxis"</code>,
otherwise it will call the RowDataPlot method.</p></li>
<li><p><code>.fullName(x)</code> will return <code>"MA plot"</code>.</p></li>
</ul>

<p>For monitoring reactive expressions:</p><ul>
<li><p><code>.createObservers(x, se, input, session, pObjects, rObjects)</code> sets up observers for all new slots described above, as well as in the parent classes via the RowDataPlot method.</p></li>
</ul>

<p>For creating the plot:</p><ul>
<li><p><code>.generateDotPlotData(x, envir)</code> will create a data.frame of row metadata variables in <code>envir</code>.
This should contain average abundances on the x-axis and log-fold changes on the y-axis,
in addition to an extra field specifying whether or not the feature was considered to be significantly up or down.
The method will return the commands required to do so as well as a list of labels.</p></li>
<li><p><code>.prioritizeDotPlotData(x, envir)</code> will create variables in <code>envir</code> marking the priority of points.
Significant features receive higher priority (i.e., are plotted over their non-significant counterparts) and are less aggressively downsampled when <code>Downsample=TRUE</code>.
The method will return the commands required to do this as well as a logical scalar indicating that rescaling of downsampling resolution is performed.</p></li>
<li><p><code>.colorByNoneDotPlotField(x)</code> will return a string specifying the field of the data.frame (generated by <code>.generateDotPlotData</code>) containing the significance information.
This is to be used for coloring when <code>ColorBy="None"</code>.</p></li>
<li><p><code>.colorByNoneDotPlotScale(x)</code> will return a string containing a <span class="pkg">ggplot2</span> command to add a default color scale when <code>ColorBy="None"</code>.</p></li>
<li><p><code>.generateDotPlot(x, labels, envir)</code> returns a list containing <code>plot</code> and <code>commands</code>, using the inital ColumnDataPlot ggplot and adding horizontal lines demarcating the log-fold change threshold.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>RowDataPlot, for the base class.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Making up some results:</span>
<span class='no'>se</span> <span class='kw'>&lt;-</span> <span class='fu'>SummarizedExperiment</span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>10000</span>), <span class='fl'>1000</span>, <span class='fl'>10</span>))
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>se</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"GENE_"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>se</span>)))
<span class='fu'>rowData</span>(<span class='no'>se</span>)$<span class='no'>PValue</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>se</span>))
<span class='fu'>rowData</span>(<span class='no'>se</span>)$<span class='no'>LogFC</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>se</span>))
<span class='fu'>rowData</span>(<span class='no'>se</span>)$<span class='no'>AveExpr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>se</span>))

<span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span>()) {
    <span class='fu'>iSEE</span>(<span class='no'>se</span>, <span class='kw'>initial</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'>MAPlot</span>()))
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#slot-overview">Slot overview</a></li>
      <li><a href="#constructor">Constructor</a></li>
      <li><a href="#supported-methods">Supported methods</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Aaron Lun</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://kevinrue.github.io'>Kevin Rue-Albrecht</a>, <a href='https://csoneson.github.io'>Charlotte Soneson</a>, <a href='https://federicomarini.github.io'>Federico Marini</a>, <a href='https://LTLA.github.io'>Aaron Lun</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


