<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>The LogFCLogFCPlot class — LogFCLogFCPlot-class • iSEEu</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="The LogFCLogFCPlot class — LogFCLogFCPlot-class"><meta name="description" content="The LogFCLogFCPlot is a RowDataPlot subclass that is dedicated to creating a scatter plot of two log-fold changes.
Each axis contains the log-fold change for a differential expression analysis and each point represents a feature."><meta property="og:description" content="The LogFCLogFCPlot is a RowDataPlot subclass that is dedicated to creating a scatter plot of two log-fold changes.
Each axis contains the log-fold change for a differential expression analysis and each point represents a feature."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">iSEEu</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/iSEEu.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/iSEE/iSEEu/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The LogFCLogFCPlot class</h1>
      <small class="dont-index">Source: <a href="https://github.com/iSEE/iSEEu/blob/devel/R/LogFCLogFCPlot.R" class="external-link"><code>R/LogFCLogFCPlot.R</code></a></small>
      <div class="d-none name"><code>LogFCLogFCPlot-class.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The LogFCLogFCPlot is a RowDataPlot subclass that is dedicated to creating a scatter plot of two log-fold changes.
Each axis contains the log-fold change for a differential expression analysis and each point represents a feature.</p>
    </div>


    <div class="section level2">
    <h2 id="slot-overview">Slot overview<a class="anchor" aria-label="anchor" href="#slot-overview"></a></h2>


<p>The following slots control the thresholds used in the visualization:</p><ul><li><p><code>XPValueField</code>, a string specifying the field of <code>rowData</code> containing the p-values for the x-axis comparison.</p></li>
<li><p><code>YPValueField</code>, a string specifying the field of <code>rowData</code> containing the p-values for the y-axis comparison.</p></li>
<li><p><code>PValueThreshold</code>, a numeric scalar in (0, 1] specifying the threshold to use on the (adjusted) p-value.
Defaults to 0.05.</p></li>
<li><p><code>LogFCThreshold</code>, a non-negative numeric scalar specifying the threshold to use on the log-fold change.
Defaults to 0.</p></li>
<li><p><code>PValueCorrection</code>, a string specifying the multiple testing correction to apply.
Defaults to <code>"BH"</code>, but can take any value from <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust.methods</a></code>.</p></li>
</ul><p>In addition, this class inherits all slots from its parent RowDataPlot,
RowDotPlot, DotPlot and Panel classes.</p>
    </div>
    <div class="section level2">
    <h2 id="constructor">Constructor<a class="anchor" aria-label="anchor" href="#constructor"></a></h2>


<p><code>LogFCLogFCPlot(...)</code> creates an instance of a LogFCLogFCPlot class,
where any slot and its value can be passed to <code>...</code> as a named argument.</p>
<p>Users are expected to load relevant statistics into the <code>rowData</code> of a SummarizedExperiment.
There should be two columns for the p-values from each comparison - and another two for the corresponding log-fold changes - for each gene/row, see Examples.
The expected column names (and how to tune them) are listed at <code>?"<a href="registerDEFields.html">registerPValueFields</a>"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="supported-methods">Supported methods<a class="anchor" aria-label="anchor" href="#supported-methods"></a></h2>


<p>In the following code snippets, <code>x</code> is an instance of a RowDataPlot class.
Refer to the documentation for each method for more details on the remaining arguments.</p>
<p>For setting up data values:</p><ul><li><p><code>.cacheCommonInfo(x, se)</code> returns <code>se</code> after being loaded with class-specific constants.
This includes <code>"valid.p.fields"</code> and <code>"valid.lfc.fields"</code>, character vectors containing the names of valid <code>rowData</code> columns for the p-values and log-fold changes, respectively.</p></li>
<li><p><code>.refineParameters(x, se)</code> returns <code>x</code> after setting <code>XAxis="Row data"</code>
as well as <code>"PValuePattern"</code> and <code>"LogFCPattern"</code> to their corresponding cached values.
This will also call the equivalent RowDataPlot method for further refinements to <code>x</code>.
If valid p-value and log-fold change fields are not available, <code>NULL</code> is returned instead.</p></li>
</ul><p>For defining the interface:</p><ul><li><p><code>.defineDataInterface(x, se, select_info)</code> returns a list of interface elements for manipulating all slots described above.</p></li>
<li><p><code>.panelColor(x)</code> will return the specified default color for this panel class.</p></li>
<li><p><code>.allowableXAxisChoices(x, se)</code> returns a character vector specifying the acceptable log-fold change-related variables in <code>rowData(se)</code> that can be used as choices for the x-axis.</p></li>
<li><p><code>.allowableYAxisChoices(x, se)</code> returns a character vector specifying the acceptable log-fold change-related variables in <code>rowData(se)</code> that can be used as choices for the y-axis.</p></li>
<li><p><code>.hideInterface(x, field)</code> will return <code>TRUE</code> for <code>field="XAxis"</code>,
otherwise it will call the RowDataPlot method.</p></li>
<li><p><code>.fullName(x)</code> will return <code>"LogFC-logFC plot"</code>.</p></li>
</ul><p>For monitoring reactive expressions:</p><ul><li><p><code>.createObservers(x, se, input, session, pObjects, rObjects)</code> sets up observers for all new slots described above, as well as in the parent classes via the RowDataPlot method.</p></li>
</ul><p>For creating the plot:</p><ul><li><p><code>.generateDotPlotData(x, envir)</code> will create a data.frame of row metadata variables in <code>envir</code>.
This contains the two sets of log-fold changes on both axes,
plus an extra field specifying whether or not the feature was considered to be significantly up or down.
The method will return the commands required to do so as well as a list of labels.</p></li>
<li><p><code>.prioritizeDotPlotData(x, envir)</code> will create variables in <code>envir</code> marking the priority of points.
Significant features receive higher priority (i.e., are plotted over their non-significant counterparts) and are less aggressively downsampled when <code>Downsample=TRUE</code>.
The method will return the commands required to do this as well as a logical scalar indicating that rescaling of downsampling resolution is performed.</p></li>
<li><p><code>.colorByNoneDotPlotField(x)</code> will return a string specifying the field of the data.frame (generated by <code>.generateDotPlotData</code>) containing the significance information.
This is to be used for coloring when <code>ColorBy="None"</code>.</p></li>
<li><p><code>.colorByNoneDotPlotScale(x)</code> will return a string containing a <span class="pkg">ggplot2</span> command to add a default color scale when <code>ColorBy="None"</code>.</p></li>
<li><p><code>.generateDotPlot(x, labels, envir)</code> returns a list containing <code>plot</code> and <code>commands</code>, using the inital ColumnDataPlot <a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a> and adding horizontal lines demarcating the log-fold change threshold.</p></li>
</ul><p>For documentation:</p><ul><li><p><code>.definePanelTour(x)</code> returns an data.frame containing the steps of a panel-specific tour.</p></li>
<li><p><code>.getDotPlotColorHelp(x, color_choices)</code> returns a function that generates an <span class="pkg">rintrojs</span> tour for the color choice UI.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>RowDataPlot, for the base class.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Aaron Lun</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Making up some results:</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span>, <span class="fl">1000</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"GENE_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">PValue1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">LogFC1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">PValue2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">LogFC2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">iSEE</span><span class="op">(</span><span class="va">se</span>, initial<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">LogFCLogFCPlot</span><span class="op">(</span>XAxisRowData<span class="op">=</span><span class="st">"LogFC1"</span>, YAxis<span class="op">=</span><span class="st">"LogFC2"</span>,</span></span>
<span class="r-in"><span>        XPValueField<span class="op">=</span><span class="st">"PValue1"</span>, YPValueField<span class="op">=</span><span class="st">"PValue2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Rue-Albrecht, Charlotte Soneson, Federico Marini, Aaron Lun.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

